SHELL = @SHELL@

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
srcdir = @srcdir@
libdir = @libdir@
top_srcdir = @top_srcdir@

CC = @CC@
CFLAGS = -O @CFLAGS@ 
LDFLAGS = @LDFLAGS@
AR = @AR@
ARFLAGS = @ARFLAGS@
RANLIB = @RANLIB@
EXEEXT = @EXEEXT@

INSTALL = @INSTALL@


LIBNAME = emapf
LIBA = lib$(LIBNAME).a

SOURCE = cc2gll.c cc2gxy.c ccurv.c cg2cll.c cgszll.c cgszxy.c cpolll.c \
 cpolxy.c eqvlat.c logabova.c mkgeoid.c stcm1p.c stcm2p.c stlmbr.c ymercfns.c

all: library

mkgeoid.o : mkgeoid.c geoids.h

library : $(LIBA)
$(LIBA) : $(SOURCE:.c=.o)
	$(AR) $(ARFLAGS) r $(LIBA) $?
	- $(RANLIB) $(LIBA)

install: library
	$(INSTALL) -d $(libdir)
	$(INSTALL) -m 644 $(LIBA) $(libdir)
# for use with install-sh, perms 644 must be separated from -m

clean:
	rm -f *.o *.a tseqlat$(EXEEXT) geoidtst$(EXEEXT) testemapf${EXEEXT}

distclean: clean
	rm -rf config.* Makefile cmapf.h autom4te.cache

geoidtst: geoidtst.c $(LIBA) cmapf.h geoids.h
	$(CC) $(CFLAGS) -o geoidtst  geoidtst.c -L./ -lemapf -lm

test: testemapf.c $(LIBA) cmapf.h geoids.h
	$(CC) $(CFLAGS) -o testemapf testemapf.c -L. -lemapf -lm

tseqlat: tseqlat.c $(LIBA) cmapf.h geoids.h
	$(CC) $(CFLAGS) -o tseqlat tseqlat.c -L. -lemapf -lm
